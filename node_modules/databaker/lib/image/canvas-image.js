"use strict";

require("core-js/modules/es.promise");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CanvasImage = void 0;

var _stream = require("../utils/stream");

const OSC = "\u001B]";
const BEL = "\u0007";

class CanvasImage {
  constructor(canvas) {
    this.canvas = canvas;
  }

  save(filename) {
    return (0, _stream.streamToFile)(this.canvas.createPNGStream(), filename);
  }

  async show() {
    if (process.env && process.env.TERM_PROGRAM === "iTerm.app") {
      const body = (await (0, _stream.streamToBuffer)(this.canvas.createPNGStream())).toString("base64");
      process.stdout.write(`${OSC}1337;File=inline=1:${body}${BEL}\n`);
    } else {
      throw new Error("show method is only available in iTerm2.");
    }
  }

  stream() {
    return this.canvas.createPNGStream();
  }

}

exports.CanvasImage = CanvasImage;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbWFnZS9jYW52YXMtaW1hZ2UudHMiXSwibmFtZXMiOlsiT1NDIiwiQkVMIiwiQ2FudmFzSW1hZ2UiLCJjb25zdHJ1Y3RvciIsImNhbnZhcyIsInNhdmUiLCJmaWxlbmFtZSIsImNyZWF0ZVBOR1N0cmVhbSIsInNob3ciLCJwcm9jZXNzIiwiZW52IiwiVEVSTV9QUk9HUkFNIiwiYm9keSIsInRvU3RyaW5nIiwic3Rkb3V0Iiwid3JpdGUiLCJFcnJvciIsInN0cmVhbSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBSUE7O0FBRUEsTUFBTUEsR0FBRyxHQUFHLFNBQVo7QUFDQSxNQUFNQyxHQUFHLEdBQUcsUUFBWjs7QUFFTyxNQUFNQyxXQUFOLENBQW1DO0FBQ2pDQyxFQUFBQSxXQUFQLENBQTBCQyxNQUExQixFQUEwQztBQUFBO0FBQ3pDOztBQUVNQyxFQUFBQSxJQUFQLENBQVlDLFFBQVosRUFBNkM7QUFDM0MsV0FBTywwQkFBYSxLQUFLRixNQUFMLENBQVlHLGVBQVosRUFBYixFQUE0Q0QsUUFBNUMsQ0FBUDtBQUNEOztBQUVELFFBQWFFLElBQWIsR0FBbUM7QUFDakMsUUFBSUMsT0FBTyxDQUFDQyxHQUFSLElBQWVELE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxZQUFaLEtBQTZCLFdBQWhELEVBQTZEO0FBQzNELFlBQU1DLElBQUksR0FBRyxDQUFDLE1BQU0sNEJBQWUsS0FBS1IsTUFBTCxDQUFZRyxlQUFaLEVBQWYsQ0FBUCxFQUFzRE0sUUFBdEQsQ0FBK0QsUUFBL0QsQ0FBYjtBQUNBSixNQUFBQSxPQUFPLENBQUNLLE1BQVIsQ0FBZUMsS0FBZixDQUFzQixHQUFFZixHQUFJLHNCQUFxQlksSUFBSyxHQUFFWCxHQUFJLElBQTVEO0FBQ0QsS0FIRCxNQUdPO0FBQ0wsWUFBTSxJQUFJZSxLQUFKLENBQVUsMENBQVYsQ0FBTjtBQUNEO0FBQ0Y7O0FBRU1DLEVBQUFBLE1BQVAsR0FBMEI7QUFDeEIsV0FBTyxLQUFLYixNQUFMLENBQVlHLGVBQVosRUFBUDtBQUNEOztBQW5CdUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYW52YXMgfSBmcm9tIFwiY2FudmFzL3R5cGVzXCJcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSBcInN0cmVhbVwiXG5cbmltcG9ydCB7IEltYWdlIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvaW1hZ2VcIlxuaW1wb3J0IHsgc3RyZWFtVG9CdWZmZXIsIHN0cmVhbVRvRmlsZSB9IGZyb20gXCIuLi91dGlscy9zdHJlYW1cIlxuXG5jb25zdCBPU0MgPSBcIlxcdTAwMUJdXCJcbmNvbnN0IEJFTCA9IFwiXFx1MDAwN1wiXG5cbmV4cG9ydCBjbGFzcyBDYW52YXNJbWFnZSBpbXBsZW1lbnRzIEltYWdlIHtcbiAgcHVibGljIGNvbnN0cnVjdG9yKHB1YmxpYyBjYW52YXM6IENhbnZhcykge1xuICB9XG5cbiAgcHVibGljIHNhdmUoZmlsZW5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBzdHJlYW1Ub0ZpbGUodGhpcy5jYW52YXMuY3JlYXRlUE5HU3RyZWFtKCksIGZpbGVuYW1lKVxuICB9XG5cbiAgcHVibGljIGFzeW5jIHNob3coKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52LlRFUk1fUFJPR1JBTSA9PT0gXCJpVGVybS5hcHBcIikge1xuICAgICAgY29uc3QgYm9keSA9IChhd2FpdCBzdHJlYW1Ub0J1ZmZlcih0aGlzLmNhbnZhcy5jcmVhdGVQTkdTdHJlYW0oKSkpLnRvU3RyaW5nKFwiYmFzZTY0XCIpXG4gICAgICBwcm9jZXNzLnN0ZG91dC53cml0ZShgJHtPU0N9MTMzNztGaWxlPWlubGluZT0xOiR7Ym9keX0ke0JFTH1cXG5gKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzaG93IG1ldGhvZCBpcyBvbmx5IGF2YWlsYWJsZSBpbiBpVGVybTIuXCIpXG4gICAgfVxuICB9XG5cbiAgcHVibGljIHN0cmVhbSgpOiBSZWFkYWJsZSB7XG4gICAgcmV0dXJuIHRoaXMuY2FudmFzLmNyZWF0ZVBOR1N0cmVhbSgpXG4gIH1cbn1cbiJdfQ==